---
title: "Chapter 5 - Appendix"
author: "Samuel Matthews"
date: "31 January 2017"
output:
  html_document: default
  pdf_document: default
header-includes: \usepackage[fleqn]{amsmath}
---

```{r, message=FALSE, warning=F}
library(ggplot2)
library(dplyr)
```

## __5.2 Geometric Growth Revisited__

For most fish, the __*potential*__ population growth is immense. One of the reasons that people believed that cod populations were indestructible was that a mature female cod may produce up to 9 million eggs in one spawning season—if they all matured, she could generate a respectable new school of cod on her own for every year that she survived. But since many other species like to eat fish eggs and larvae, most eggs never become fish.

We can calculate the number of new individuals in a year as:
$$Total~new~recruits = bN$$
__*Where*__

+ $b$ is the average annual number of new fish produced per year per individual—the per capita recruitment (sometimes called per capita births, even though only the newborns that survive to the next year are counted) and  

+ $N$ is the number of fish in the population.

But every year, many individuals also die: the total number of deaths can be expressed as:
$$Total~deaths = dN$$
__*Where*__

+ $d$ is the proportion of individuals dying per year (the per capita mortality); you can also think of this as the probability that any given individual will die, on average

+ $N$ is the number of fish.

<span style="color:blue">
__*NB Per capita recruitment*__ *(the number of new individuals per existing individual recruited into the population between 1 year and the next)* __*is obviously not the same as the number of eggs laid. For example, a female tiger prawn may produce 800,000 eggs in a season but if, on average, only 1 of the larvae hatching from those eggs actually manages to join the population as a prawn the next year, then assuming a 50:50 sex ratio, $b=0.5$.*__
</span>

We will make a number of simplifying assumptions:

1. The number of new recruits per individual is the same for all individuals from age 1 onwards, regardless of their age.    
2. Every individual from age 1 onward has the same chance of dying, regardless of their age.    
3. Per capita recruitment and natural per capita mortality remain constant from one year to the next.  

In nature, none of these assumptions holds, and much of contemporary fisheries modelling is about realistically capturing some of these additional complexities. However, as with much modelling in science, we start with the “simplest possible” model, and we gradually build things up from there.

Getting back to our model, the assumptions just stated imply that the population change each year should be modelled as
$$
\begin{aligned}
\Delta N &= G(N) = bN-dN\\ 
         &= (b-d)N
\end{aligned}         
$$
This says that the population change each year can be modelled as total births minus total deaths. If there are more new recruits than deaths, $\Delta N$ is positive, and the population will increase; if there are more deaths than recruits, $\Delta N$ is negative, and the population will decline. $\Delta N$ also depends on $N$, since a larger population means that there are more individuals to reproduce or die.  
Note that quantity $(b - d)$ is the proportion or percentage by which the population grows or shrinks every year (e.g., $b - d = 0.2$) means the population grows by 20% every year). For now, we will simplify the way we write this by defining $b - d = R$. Population biologists sometimes refer to $R$ as the net *per-capita* rate of increase. This simplifies the way we write our population growth equation slightly:
$$\Delta N = G(N) = RN$$

The population will not change from one year to the next if either $R = 0$ or if
$N = 0$. It shrinks over time if $R < 0$, and grows if $R > 0$.

-----------------------------------------------------------------------------

#### __*Exercise*__

1. In Chapter 4 we described geometric growth with the equation
$$N_{t+1}=\lambda N_t$$  
__*Where*__    
* $Nt+1$$ is the population size at time t+1  
* $Nt$ is the population size at time t  
* $\lambda$ is a constant factor by which the population increases per time unit    

    __*Show that*__ 
$$N_{t+1}=\lambda N_t ~~equates~to ~~ \Delta N_{t~to~t+1}=RN_t$$  
    __*Where*__ 

* $\lambda = 1+R$

-----------------------------------------------------------------------------

### __*Example 5.2: A population with constant birth and death rates*__

Suppose that:

* 50% of the fish population is always female  
* each female in the population lays 10 eggs per year  
* 20% of the eggs produce new fish which join the population the next year  
* 50 % of the fish die each year,  
then - 

$$
\begin{aligned}
b &=0.5 \times 10 \times 2\\ 
&=1.0\\
d &=0.5\\ 
b-d &=1-0.5\\ 
R &=0.5
\end{aligned}
$$
Therefore
$$
\begin{aligned}
\Delta N &= G(N) =0.5N\\
&and\\
\lambda &= 1+0.5\\
&= 1.5
\end{aligned}
$$
Since $\Delta N = 0.5N$, the population will increase by 50% each year. The larger the population size $N$, the larger $\Delta N = 0.5N$ will be.  
We will start with a population of 2 fish. To examine the annual changes in $N$ and $\Delta N$ over 10 years for this population, open a new R Script and define the parameters as shown in the following code chunk.

```{r SetParameters, cache=T}
## Set parameters

## b = 1 and d = 0.5
## There will be 10 time units, starting population = 2

b=1 
d=0.5
Times = 10
StartPopulation = 2

## To re-run the model with different parameters, only the values in this 4-line code block need to be changed
```

#### *Pseudo-code*
Create 4 empty vectors of length `Times+1` to hold:

1. Times, $t$ (`Time`),   
2. Population numbers, $N$ (`N`), 
3. Poulation Growth, $G(N)$ (`G.N`) 
4. Change in population, $\Delta N$ (`delta.N`)

`N`, `G.N` and `delta.N` are created with all zero values by default; 
but since 0 could be a real value the zeroes should be replaced by missing values (`NA`). Each numbered comment refers to each sequential line of code.

```{r CreateModelOuts, cache=T}
# 1.
Time = 0:Times            #Create vector between zero and the amount of timesteps (t)

# 2.
N = numeric(Times+1)      #Create an empty numeric vector (length=t+1), to store poulation size
N[N==0]=NA                #Change all 0's to NA's
N[1] = StartPopulation    #Assign the first element of N to our starting population size

# 3.
G.N = numeric(Times+1)    #Create an empty numeric vector (length=t+1), to store poulation growth
G.N[G.N==0]=NA            #Change all 0's to NA's

# 4. 
delta.N = numeric(Times+1)#Create an empty numeric vector (length=t+1), to store change in population size
delta.N[delta.N==0]=NA    #Change all 0's to NA's
```

Now all of our parameters are set, vectors have been created and the model is ready to be run.

<span style="color:blue">
__*NB this model does not contain harvesting so $\Delta N = G(N)$ `delta.N = G.N`*__
</span>

#### *Pseudo-code* 
1. Calculate the value of $R$
2. Loop over `Times` (the amount of timesteps), using a `for` loop.  
3. Store the vectors in a `data.frame`  called `GeometricGrowth` and display it (rounding to 2 decimal places) `round`


```{r RunModel, cache=T}
# 1. Calculate the value of R
R = b - d

# 2. Loop over Times, calculating the population changes and the new population size at each successive time
##  NB no harvesting so delta.N = G.N
for (time in 1:Times)
{
  G.N[time]= R * N[time]
  delta.N[time] = G.N[time]
  N[time+1] = N[time] + delta.N[time]
}
# 3.  Store the vectors in a data frame and display it (rounding to 2 decimal places)
GeometricGrowth = data.frame(Time, N, G.N, delta.N)
round(head(GeometricGrowth,10),2)
```

<span style="color:blue">
__*NB It is good practice to calculate the first few values of $N$ on a piece of paper or with a calculator as a check that you have constructed the model correctly and it is behaving as you expect.*__
</span>

Notice that both $N$ and $ΔN$ increase by 50% in each time unit.

Now we will plot our results using both base R and ggplot2

#### *Psuedo-code: Plotting in Base Graphics*
1. Plot population size against time; `plot(x ~ y)`
2. Add titles `xlab=""`, `ylab=:""`, `main=""`
3. Add label for $b$ and $d$; `text`


```{r PlotModelBase}
## Show the values for b & d on the plot (NB label position may need to change when different parameters are used)
with(GeometricGrowth, plot(N ~ Time, type="l", las=1, lwd=2, col="red",      #1.
                           ylab="Population (N)", main="Geometric growth"))  #2.
label = paste("b = ", b,", d = ", d)                                         #3.  
text(4,N[10], label)
```

What happens to $N$ and $G(N)$ if you now change the value of $b$ from 0.5 (the same value as $d$) to 0.1?

In the plot above, we have plotted $N$ against time. We now look at the behaviour of $G(N)$: as $N$ increases, so does $G(N)$, as we would expect from the relationship:  
$$G(N)=(b-d)N=RN$$
```{r PlotProductionFunction, cache=T}
## Plot the Production function (G.N against N)
with(GeometricGrowth, plot(G.N ~ N, type="l",  lwd=2, col="red", xlab="Population (N)", ylab="G(N)", main="Production function"))
text(N[10],G.N[5], label)
```

#### *Psuedo-code: Plotting in ggplot2*

* Make sure ggplot2 is installed: `install.packages(ggplot2)`
* Attach ggplot2: `library(ggplot2)`
1. Create plot of Geometric Growth dataframe; `ggplot()`
2. Add line of population `N` against time `Time`; `geom_line()`
3. Add titles; `xlab("")`, `ylab("")`, `ggtitle("")`
4. Add label for $b$ and $d$; `annotate("")`
5. Choose theme; e.g. `theme_classic()`

Repeat process for production function except change step 2
2. Add line of growth (production) `G.N` against population size `N`; `geom_line()`


```{r PlotModelggplot, cache=T}
library(ggplot2)
# Save our label as an object (in this case, b=1, d=0.5)
label = paste("b = ", b,", d = ", d)
# Plot Geometric Growth
ggplot(GeometricGrowth) +                                 #1.
  geom_line(aes(x=Time, y=N), color='blue') +             #2.
  xlab("Time") + ylab("Population (N)") +                 #3.
  ggtitle("Geometric Growth") +
  annotate("text", x = 4, y = 50, label = label) +        #4.  
  theme_classic()                                         #5.

# Plot Production Function                  
ggplot(GeometricGrowth) +                                 #1.
  geom_line(aes(x=N, y=G.N), color='blue') +              #2.
  xlab("Population (N)") + ylab("G(N)") +                 #3.
  ggtitle("Geometric Growth") +                           
  annotate("text", x = N[5], y = G.N[5], label = label) + #4.
  theme_classic()                                         #5.
```

<span style="color:blue">      
__*NB save the script for the model and plots as `GeometricModel.R` ... you can save your plots as images from the plots tab if you wish.*__
</span>

<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.3.blah.png) 
</div>


Notice that, for the geometric model, the population is only predicted to be at
equilibrium (i.e., to neither grow nor shrink) when $N = 0$.

-----------------------------------------------------------------------------

#### __*Exercise*__

2. This exercise assumes that you have built the model and plots shown in Figures 5.2-2 to 5.2-4 for yourself.   
  (a) If the *per capita* recruitment $b = 0.5$, and the *per capita* mortality $d = 0.1$, what is the value of $R$?  
  (b) Assume the population in (a) starts with 2 fish. Draw plots to show  
      (i) How the population grows over a 50-year period
      (ii) The production function for the range of population sizes achieved.   
  (c) Assume the population starts with 200 fish.
      (i) If the *per capita* recruitment $b = 0.5$, and the *per capita* mortality $d = 0.6$, what is the value of $R$? 
      (ii) Plot the population size and the production function for this population over 10 years.
      (iii) How large is the population after 5 and after 10 years?

<span style="color:blue">      
__*NB all you should have to change in your script are the initial model parameters*__
</span>

-----------------------------------------------------------------------------

This modelling approach makes three unrealistic assumptions: 

1. That the population will always grow exponentially, regardless of the population size. We will reconsider that assumption in the next section (5.3) and modify the population model accordingly.  
2. That we have perfect knowledge of the stock size $N$, and the “natural” per capita increase $R (= b – d)$. We will also examine the effects of imperfect knowledge in Section 5.3.  
3. That the birth and death rates (and consequently the value of $R$), are constant from year to year. We will look at the effect of year-to-year variation in $R$ in section 5.4.

## __5.3 Limits to population increase__

In section 5.2 our underlying population model was of geometric growth. Most biological populations will indeed grow geometrically in favourable condi- tions—but no population can grow geometrically forever. Sooner or later, the population will start to run out of resources such as food or living space. In general, as population size increases, both recruitment rates and death rates are likely to be affected:

+ Reproduction requires energy and nutrients to invest in offspring: as
food becomes harder to obtain, the birth rate is likely to decline.  
+ Territorial or sedentary species may die or fail to reproduce in the absence of sufficient appropriate living space or breeding sites.  
+ Dense, crowded populations are susceptible to new risks—disease is more likely, predators may become more abundant, and if food is short, individuals may starve. Consequently, death rates are likely to increase.

### __*How does $R$ change with population size?*__

The simplest form of this relationship is when population growth rates change
linearly with population size.

Remember that when $b$ (*per capita recruitment*) $> d$ (*per capita mortality*) the population will grow, when $b < d$ the population will decline, and when $b = d$ it will remain stable.  

As per capita recruitment declines with population size, and the per capita deaths increase, there will be a point where the two lines cross (Figure 5.3-1) below.

<div style="text-align:center" markdown="1"> 
![](Chapter 5/Fig5.3.1.png)
</div>


The crossing point, where $b = d$ (and therefore $R = 0$), is called the carrying capacity ($K$).

+ When the population size $N > K$, $N$ will decline.    
+ When the population size $N < K$, $N$ will increase.  

If the relationships between N and b and between N and d are both linear, then the relationship between N and R (= b - d) will also be linear (Figure 5.3-2). What this means is that the effect of adding an extra individual to the popula- tion always has the same effect, regardless of the population size: the value of R decreases by some constant amount for every new individual.

<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.3.2.png)
</div>

Because $∆N = RN$, when $N = K$, $∆N = 0$ and the population remains stable. This means that, when $N = K$, the population is at equilibrium (we expect it to neither grow nor shrink over time)—provided of course that there is no harvesting.

If we have a scatter plot with a fitted straight line to predict $R$ (the y-value) from $N$ (the x-value) as in Figure 5.3-3, then the parameters a and b of the fitted line $R = a + bN$ can be used to give us estimates for $R_0$ and $K$:

+ $R_0$ is given by the intercept $a$.  
+ From Figure 5.3-3 the slope $b = -\frac{R_0}{K}$. Therefore $K = -\frac{R_0}{b}$

The equation for the straight line $R = a + bN$ can therefore be written:

$$R = R_0 - \frac{R_0}{K}N\\
or\\
R = R_0\left( 1-\frac{N}{K}\right)    ...(1)$$

which we will make use of later.

<span style="color:blue">
__*The key equations that you will need to use again have been numbered*__
</span>

R is not always a linear function of population size, but Figure 5.3-3 shows an example where a straight line is as good an approximation as any. This shows the relationship between year-to-year population growth rate and larval popu- lation size in a small fly (*Phytobia betulae*), whose larvae are wood-borers, living and feeding just under the bark of Scandinavian birch trees.

<span style="color:blue">
__*NB*__ *The Phytobia betulae data* 
__*Birch trees grow only during the warmer months, and the wood shows clear annual growth rings. Because the larvae live only in the tree cambium (the wood just below the bark), the density of larvae for each year ($Nt$) during the life of a tree could be esti- mated by cutting sections of the tree and counting larval tunnels left in the wood of each growth ring.*__
__*In these data, $R$ has been calculated from the population growth rate ($λ$) for each succes- sive year estimated as $\frac{Nt+1}{Nt}$ (see Exercise 1).*__
__*Notice that although there is an obvious negative relationship between population growth rate and numbers of larvae per tree, the relationship is quite "noisy" - in particular, there are some years where population growth is unusually low. When popula- tion growth rates are estimated from a time series of field data, as in this case, year-to-year variation in environmental conditions will also affect population growth rates. This can make evaluating the relationship between popu- lation density and population growth rate quite difficult.*__
</span>

<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.3.3.png)
</div>

The relationship between $R$ and population size often depends on the details of the particular mechanisms by which crowding impacts birth and death rates, so it is not always a straight line. We discuss some of these issues in section 5.5. However, the basic lessons of this chapter do not depend on the use of this particular way of modelling effects of crowding. The same principles apply to alternative models.

-----------------------------------------------------------------------------

#### __Exercise__

If we have a time series of population sizes $N_0$, $N_1$, $N_2$, ... $N_t$, $N_{t+1}$ ... etc, then for each value of N except the last, we can estimate $λ_t$  as $N_{t+1}/N_t$. From the values of λ we can then estimate the value of $R$ achieved at each population size (Exercise 1).

3. The file `Paramecium_aurelia.csv` contains the results of a single trial carried out by Gause in 1934, who examined population growth of the single-celled protozoan Paramecium aurelia in the laboratory. The data are protozoan densities in a laboratory population each day over a period of 20 days.

  (a) Use these data to estimate the values of $λ$ and $R$ on each day. 
  (b) Draw a scatterplot of the relationship between $R$ and $N$.
  (c) Fit a regression to estimate $R$ from $N$.
  (d) Use the parameters of the regression equation to estimate $R_0$ and $K$.
  (e) Explain what $R_0$ and $K$ represent in this system.
  (f) What is the estimated value of $R$ when $N$ (the number of Paramecium) is:
  + 200?
  + 700?  
  (data obtained from Roughgarden 1998)
  
-------------------------------------------------------------------------------------------

### __*What is the production function when $R$ decreases linearly as population size increases?*__

Because  $∆N = G( N ) = RN$ in the absence of harvesting, and because $R$ decreases linearly with population size, it follows from Figure 5.3-3 that the production function must be hump-shaped (Figure 5.3-4):

* When $N = 0, G( N ) = R\times0 = 0$ 
* When $N = K, G( N ) = 0\times N = 0$
* When $N$ is between $0$ and $K$, $N$ and $R$ are both positive, so $G(N)$ is positive 
* When $N > K$, $R$ is negative but $N$ is positive, so $G(N)$ is negative
     
<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.3.4.png)  
</div>
 
### __*Logistic population growth*__ 

For any value of $N$, $G(N) = RN$ , so we can use equation (1) from earlier and substitute for the value of $R$ to obtain

$$G(N) = \left( R_0 - \frac{R_0}{K}N\right)N\\
or\\
G(N) = R_0\left( 1-\frac{N}{K}\right)N$$

This is called the __*logistic equation*__, and populations which behave in this way are said to be showing __*logistic growth*__—the simplest form of density-dependent population growth.

The logistic equation is essentially an equation for exponential growth

$$G(N)=R_0N$$
modified by the factor

$$\left(1-\frac{N}{K}\right)$$
That is, the value of R in any particular year will be $R_0\left(1-\frac{N}{K}\right)$
When $N$ is very small relative to $K$, the factor $\left(1-\frac{N}{K}\right)$ will be close to 1 and the population will grow exponentially. As $N$ increases, $\left(1-\frac{N}{K}\right)$ will decrease, and the population will grow more slowly. When $N$ reaches $K$, $\left(1-\frac{N}{K}\right)$ reaches 0, and the population stabilizes (Figure 5.3-5). If the population begins with $N > K$, $\left(1-\frac{N}{K}\right)$ is negative, and the population will decline until $N$ reaches $K$ (Figure 5.3-5).

<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.3.5.png)
</div>


-----------------------------------------------------------------------------

#### __Exercise__

Using the relationship between $R$ and $N$ estimated for Paramecium aurelia from Exercise 3:  

4. Write the logistic equation to describe growth in the Paramecium population, and estimate $G(N)$ and the population size one time unit later when:    
    (a) N (the number of Paramecium) = 0
    (b) N = 1
    (c) N = 100
    (d) N = 300
    (e) N = 500
    (f) N = 700
  
-------------------------------------------------------------------------------------------

### __*Example 5.3 Modelling harvest effects in populations showing logistic growth*__ 

Now we can build harvesting into a model for logistic growth, and think again
about how to harvest sustainably.

Recall that the first requirement for sustainability is to find a harvest, and a stock size, where the stock will be in equilibrium—that is, where $h = G(N)$ so that $\Delta N = 0$. We can use a similar Excel model to the one which we used for exponential growth to exhibit logistic growth. The logistic model will need to provide a value for $K$ and change the formula for calculating $G(N)$ to the logistic equation

$$G(N) = R_0\left( 1-\frac{N}{K}\right)N$$


We can then add the effects of harvesting to the model by subtracting the harvest target from $G(N)$ to calculate $ΔN$, the change in population size from one year to the next:

$$ΔN = G(N)~–~ h$$

The model with harvesting will then be:

$$ΔN = G(N) – h = R_0\left( 1-\frac{N}{K}\right)N~-~h$$

Notice that there is one thing that is unrealistic about our equation for logistic growth with harvesting. If the population size is really low, and we treat h as a constant value that is bigger than $N_t + G(N)$, then the model could actually predict a negative population size. Of course, negative population sizes can’t really happen in nature. There are more sophisticated ways of handling this problem, but here we’ll just adopt a quick-and-dirty fix by stipulating a rule that, if a population is predicted to decline below zero, it is actually set at zero.
Open a new R script, and set the starting conditions as shown in the R code chunk below with the harvest target initially set to 0, the carrying capacity at 100, $R_0$ at 0.2, and the initial population size as 2 individuals.

```{r SetParamsLogistic, cahce=T}
##  Set model parameters for logistic growth 
## R0 is uncrowded rate of increase, K is carrying capacity, h is harvest
R0 = 0.2
h = 0
K = 100
Times = 100
StartPopulation = 2

## To re-run the model with different parameters, only the values in this 4-line code block need to be changed
```

#### *Pseudo-code*

<span style="color:blue">
__*NB .... same outputs as for geometric growth, we just have to account for the harvest when we calculate the population size in the next year*__
</span>

Create 4 empty vectors of length `Times+1` to hold:

1. Times, $t$ (`Time`),   
2. Population numbers, $N$ (`N`), 
3. Poulation Growth, $G(N)$ (`G.N`) 
4. Change in population, $\Delta N$ (`delta.N`)

`N`, `G.N` and `delta.N` are created with all zero values by default; 
but since 0 could be a real value the zeroes should be replaced by missing values (`NA`). Each numbered comment refers to each sequential line of code.

```{r CreateModelOutsLog,cache=T}
# 1.
Time = 0:Times            #Create vector between zero and the amount of timesteps (t)

# 2.
N = numeric(Times+1)      #Create an empty numeric vector (length=t+1), to store poulation size
N[N==0]=NA                #Change all 0's to NA's
N[1] = StartPopulation    #Assign the first element of N to our starting population size

# 3.
G.N = numeric(Times+1)    #Create an empty numeric vector (length=t+1), to store poulation growth
G.N[G.N==0]=NA            #Change all 0's to NA's

# 4. 
delta.N = numeric(Times+1)#Create an empty numeric vector (length=t+1), to store change in population size
delta.N[delta.N==0]=NA    #Change all 0's to NA's
```


once again our parameters are set, vectors have been created and the model is ready to be run.

#### *Pseudo-code* 
1. Calculate the value of $R$
2. Loop over `Times` (the amount of timesteps), using a `for` loop.  
3. Store the vectors in a `data.frame`  called `GeometricGrowth` and display it (rounding to 2 decimal places) `round`

```{r RunModelLog, cache=T}
# 1. Calculate the value of R

# 2. Loop over Times, calculating the population changes and the new population size at each successive time
##    NB (a) harvest is initally set to zero; (b) if N drops below 0 it is set to 0
for (time in 1:Times)
{
  R = R0 * (1 - N[time] / K)
  G.N[time]= R * N[time]
  delta.N[time] = G.N[time] - h
  N[time+1] = N[time] + delta.N[time]
  N[time+1] = ifelse(N[time+1] < 0, 0, N[time+1])
}

# 3.  Store the vectors in a data frame and display initial values (rounding to 2 decimal places)
LogisticGrowth = data.frame(Time, N, G.N, delta.N)
round(head(LogisticGrowth,10),2)
```

Use the data set to draw two plots

* A plot to show how $N$ changes with time     
* A plot to show the production function (how $G(N)$ changes with $N$). 

<span style="color:blue">
__*NB .... This basically the same code as for the Geometric growth, all that changes is the data frame we use as an input and the label we create for the graph, notice the utility of re-using code*__
</span>

```{r PlotBase, cache=T}
## Show the values for Ro, K and h on the plot (NB label position may need to change when different parameters are used)
with(LogisticGrowth, plot(N ~ Time, type="l", las=1, lwd=2, col="red", ylab="Population (N)", main="Logistic growth"))
label = paste("Ro = ", R0,", K = ",K, ", h = ",h)
text(50,N[10], label)
## Plot the Production function (G.N against N)
with(LogisticGrowth, plot(G.N ~ N, type="l",  lwd=2, col="red", xlab="Population (N)", ylab="G(N)", main="Production function"))
text(K/2,G.N[5], label)
```

#### *Plotting in ggplot2*

```{r PlotModelLogggplot}
library(ggplot2)
## Show the values for Ro, K and h on the plot (NB label position may need to change when different parameters are used)
label = paste("Ro = ", R0,", K = ",K, ", h = ",h)
# Plot Logistic Growth
ggplot(LogisticGrowth) +                                  #1.
  geom_line(aes(x=Time, y=N), color='blue') +             #2.
  xlab("Time") + ylab("Population (N)") +                 #3.
  ggtitle("Logistic Growth") +
  annotate("text", x = 50, y = N[10], label = label) +    #4.  
  theme_classic()                                         #5.

# Plot Production Function                  
ggplot(LogisticGrowth) +                                  #1.
  geom_line(aes(x=N, y=G.N), color='blue') +              #2.
  xlab("Population (N)") + ylab("G(N)") +                 #3.
  ggtitle("Logistic Growth") +                           
  annotate("text", x = K/2, y = G.N[5], label = label) +  #4.
  theme_classic()                                         #5.
```

<span style="color:blue">      
__*NB save the script for the model and plots as `LogisticModel.R` ... You can save the plot as an image from the plots tab if you wish*__
</span>

The production function tells us that with $R_0 = 0.2$ and $K = 100$, the maximum value for $G(N)$ is 5, and it is achieved when $N = K/2 = 50$

-----------------------------------------------------------------------------

#### __Exercise__

5. For the Paramecium aurelia logistic equation from Exercise 4:    
      (a) Plot the population size over 100 time units if $N_0 = 1$     
      (b) What is the maximum value achieved by $G(N)$?   
      (c)  What is the population size when $G(N)$ is at its maximum value?   

-------------------------------------------------------------------------------------------

Since in the plot of the production function above the maximum value for $G(N)$ is 5, and it is achieved when $N = K/2 = 50$, if we set the initial population size to 50 and the harvest
target $h$ to 5, the population should be at equilibrium. Set $R = 0.2, K = 100$ and $h = 5$ to demonstrate that these values predict that $N$ will remain constant over time.

More generally, if we set the harvest to any value of $G(N)$ on the production function, the population will stabilize if it reaches that point. This gives us three qualitatively different kinds of harvesting strategies. For $R_0  = 0.2$ and $K = 100$, consider three possible values of $h$ that illustrate these three possibilities (Figure 5.3-11).

```{r, cache=TRUE, fig.cap= "__Fig 5.3.11 Production function for $K=100$, $R_0 = 0.2$, showing three possible harvest targets: $h=6$, $h=5$, and $h=4$__", warning=FALSE}
ggplot(LogisticGrowth) +                                  #1.
  geom_line(aes(x=N, y=G.N), color='blue') +              #2.
  geom_hline(yintercept=4, color='red') +
  geom_hline(yintercept=5, color='red') +
  geom_hline(yintercept=6, color='red') +
  xlab("Population (N)") + ylab("G(N)") +                 #3.
  ggtitle("Logistic Growth") +                           
  annotate("text", x = K/2, y = G.N[5], label = label) +
  annotate("text", x = 95, y = 6.2, label = "h = 6") +
  annotate("text", x = 95, y = 5.2, label = "h = 5 (MSY)") +
  annotate("text", x = 95, y = 4.2, label = "h = 4") +
  theme_classic()
```
 
 
### __*Unsustainable harvesting*__

There is no point on this production function where $G(N) = 6$. This means that there is no equilibrium—no population size where natural population growth is equal to the harvest. Thus our first condition of sustainability is violated. If you set $h = 6$ and the initial population size $N_0 = 100$, it takes a little over 50 years for the population to go extinct (try it!).

### __*Maximum Sustainable Yield (MSY)*__

Now set $h = 5$ (keeping the initial population size ($N_0 = 100$). In this case, there is an equilibrium at $N = 50$: at this point $G(N) = 5$, which is the same as the harvest, and so if the population size is 50, the population should neither grow nor shrink. Thus our first condition for stability is satisfied.

This  particular  harvesting  strategy  is  infamous  in  fisheries biology,  and
goes by the name Maximum Sustainable Yield (MSY). This is because the production function peaks when $N = K/2$ , so if we set the harvest to equal population growth at this particular point, this is the largest possible harvest for which the population can be kept at equilibrium. To find this maximum harvest, we can just do a bit of algebra to find out what natural population
growth, $G(N)$, will be when $N = K/2$ :

$$
\begin{aligned}
G(N) &= R_0\left( 1-\frac{N}{K}\right)N\\
     &= R_O\left(1-\left(\frac{K}{2}\right)\left(\frac{1}{K}\right)\right)\frac{K}{2}\\
     &= \frac{R_0K}{2}\left(1-\frac{1}{2}\right)\\
     &= \frac{R_0K}{4}\\
 MSY &= \frac{R_0K}{4}
\end{aligned}
$$

As noted earlier, in fisheries management, this quantity is called the “maximum sustainable yield”, or MSY for the fishery, and for many years estimates of the MSY have been used to set catch targets. However, recall that there is a second requirement for a sustainable harvest. Not only must our harvesting keep the population at equilibrium, the equilibrium must also be ecologically stable. If the population bounces up above or below the equilibrium, we want it to natu- rally tend to go back to that equilibrium, rather than collapsing. Shortly, we’ll ask whether “Maximum Sustainable Yield” really is “sustainable” at all.

Remember that without harvest, if $N < K$, then the population will grow until $N = K$. Conversely, if the population starts with $N > K$, then it will decline until $N = K$ (Figure 5.3-5). This means that without harvest, the population is ecologically stable—if some event pushes populations above or below the equilibrium, it will tend to return to it. But what happens if the population is consistently harvested at MSY?

Using the R script `LogisticModel.R`, set the starting value of $N$ to 100, and the harvest to MSY—that is, the maximum sustainable yield, which is 5 for this model. Notice that the population declines, but appears to be stabilizing at $N$ = 50, as predicted. Now set the starting value of $N$ = 50: the population remains constant (Figure 5.3-12 (a) and (b)). But what happens if some event pushes the population below 50? Set the starting value to 45: in just over 90 years, the population is extinct (Figure 5.3-12 (c)).

<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.3.12.png)
</div>

This means that harvesting at MSY is not ecologically stable. If N drops below the equilibrium value, population numbers will continue to decrease until the population is extinct. To emphasize this, we also show a plot with an extended time period and a starting population of 48. This time, the stock decline is almost imperceptible for 100 years, but the stock is still headed for extinction.

<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.3.13.png)
</div>

### __*Harvesting below MSY*__

In  Figure  5.3-10  there  are  two  points  on  the  production  function  where $G(N) = 4$: on the left hand side, when $N \approx 28$ and on the right, when $N \approx 72$. This means that, when $h = 4$, there are two possible equilibria for the fishery population. Again, however, we want to know whether either or both of these equilibria are ecologically stable.

Set $h = 4$ (still keeping the initial population size $N_0  = 100$). Which of the two stable points does the population approach?

Now try progressively reducing the starting population size by 10—to 90, then
80, and so on. What happens?

In general, if the starting population size is greater than the lower stable point the population size will grow to the upper stable point. But if the starting popu- lation size is even slightly less than the lower stable point, the population will go extinct. This means that the lower stable point is a very unsafe target for the stock size—even small errors of estimation may result in the stock crashing.

### __*How can we achieve ecological sustainability*__

The problem with the lower stable point is the same problem as we demonstrated with harvesting at MSY: this harvesting strategy is very unsafe, since if the stock drops below the lower stable point, continuing to harvest at the same rate will eventually destroy the population.

In general, if we start with a value of $N$ above the lower stable point, the system will gradually move to its upper stable point. But if we try to maintain the stock at its lower stable point, and make a small error in our estimates of population size or growth rate, the stock will be at risk of collapse. Alternatively, if unfavourable environmental conditions reduce population growth rates for a year or two, and the harvest target is not modified, then the stock will also collapse.

Harvesting at MSY is the most profitable strategy in the short term, because it is the highest harvest target which the population might sustain—but it is highly sensitive to imperfect knowledge and environmental variation. This sensitivity is a key problem with using the MSY as the harvest target and $K/2$ as the target stock size in any real system.

* We do not know the exact value of N—the number of fish in the sea. Even using the best practicable methods to estimate N, our estimates are subject to chance errors.
* The values of $R_0$ and $K$ are also estimates—also subject to error—and they may also vary from year to year as environmental conditions change. (We will examine the effect of random variation in $R$ in more detail in the next section.)

So what should we do? Simply setting a harvest target below MSY is not enough on its own since if the population by chance drops below the lower stable point it is unlikely to recover.

A conservative approach would be to try to always operate in the right half of the production function, that is:

* Set a stock size target > $K/2$ —in this case, for example, we might try to keep the stock close to 80 rather than 50.
* Set a harvest target chosen to maintain this stock size: from Figure 5.3-11
that means a target of about 3 rather than 5.

If we run this model with a starting population of 80 and a harvest target $h$ of 3, the population stabilizes at about 81. Then, even if we make a quite significant error in our estimate of the stock size, the population will tend to return to the stable point: in fact, the starting population can be as low as 19 (why 19?), and the stock will still find its way back to the stable point (try it!).

Thus it is only for a harvest rate below MSY, and a target stock size to the right of the peak that we have a harvesting strategy that satisfies both of our criteria for sustainability:

1. __an equilibrium (harvest = natural population growth)__
2. __that is ecologically stable (a population that is close to our harvest equilibrium will tend towards it, rather than moving away).__

-----------------------------------------------------------------------------

#### __Exercises__

6. Consider a fish population in which the carrying capacity K has been estimated as 10 million fish, and with a per-capita rate of increase in uncrowded conditions ($R_0$) of approximately 1 per year. Assume that $R$ declines linearly with $N$. You are charged with providing advice on the management of the fishery   
    (a)  Write an equation to predict $R$ from the value of $N$.  
    (b) Write an equation to predict changes in $ΔN$ with population size (i.e. how $ΔN$ can be predicted from the value of $N$). Assume for the moment that there is no harvesting, i.e. $h=0$.
    (c)  What is the maximum sustainable yield (MSY) for this population? What is the target stock size if the harvest target is set to the MSY? 
    (d) Plot the production function for this population.
    (e) Model and plot the values of $N$ over a 100-year period with no harvest if the population size at the start was only 100 fish. How long does it take the population to reach its carrying capacity?
    (f) You want to allow for the possibility that your estimates of $R$ and $K$ are too optimistic and decide to recommend a harvest target that is 20% below MSY, as well as an appro- priate target stock size. What harvest and stock size targets do you recommend?
    (g) You have been over-ruled, and the harvest target has been set to your estimated MSY. The stock has not previously been fished, and when fishing begins it is at carrying capacity. In fact, $R_0$ has been overestimated—it is actually 0.9, not 1.0. But the carrying capacity $K$ has been underestimated—it is actually 11 million, not 10 million. What will happen to the fishery?
    (h) Given the errors specified in (g), what would have happened to the fishery if your recommendations (in (f)) had been followed?

7.	Estimates for the Newfoundland cod fishery are that $K$ was probably about 1.4 million tonnes of fish, and that $R_0$ was about 1 per year. Given this, what was the MSY and the target stock size (in tonnes) at MSY? Considering the history of the fishery as shown in Figure 5.0-5, why did the stock decline through the 1970’s? Why do you think it finally collapsed despite controls on the harvest?
 
-------------------------------------------------------------------------------------------

## __5.4 Assessing the *robustness* of our conclusions: modelling year-to-year variation in the rate of increase__

To this point, we have assumed that the parameters of the model remain con- stant from one year to the next. In the real world, things vary in ways we cannot predict or control, and this adds a new level of difficulty to management of a fishery. We got some insight into how this might affect a harvesting strategy, by thinking about what happens if our population is pushed up above or below an equilibrium (due to, for instance, unusually favourable or unfavourable condi- tions in any given year). However, a more realistic way to think about effects of environmental fluctuations is in terms of our population growth parameters fluctuating. In a good year, $R$ might be higher than average (lots of food for adults means more offspring produced, or better survival of offspring). In a bad year, $R$ might drop due to low reproduction, low survival of offspring, or even high death rates of adults due to starvation or disease. Similarly, in good and bad years, the population size that the environment can support (the carrying capacity, $K$), might be higher or lower than average. We want to know whether our basic rules of thumb for sustainable fishing will hold up, if we adopt this more realistic approach to modelling environmental fluctuations.

What we are doing here is a critically important part of modelling. It concerns assessing the robustness of our results. If we modify the assumptions of our models to make them more realistic, and the conclusions we drew from the simpler model hold up, we would say that our conclusions are robust to relax- ing that particular simplifying assumption. If not, we say that it is sensitive to that assumption. Because models are always simplifications of nature, we want to be confident that conclusions we draw from models are robust.

Specifically, in this section, we will concentrate on variation in $R$. Figure 5.3-3, reproduced below, demonstrates that in natural populations with no harvesting, there is a considerable amount of year-to-year “noise” or residual variation around the regression line used to predict the growth increment $R$ from the population size $N$. In other words, the straight line shows what the population does on average, but in any given year, $R$ is likely to be a little bit more, or a little bit less, than the model would predict, based on population size.


<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.3.rep.png)
</div>

<span style="color:blue">
__*NB A random number generator (RNG) is a computational or physical device designed to generate a sequence of numbers (or symbols) that lack pattern. When you toss a coin you are using a physical RNG which can only generate two possible values. R has a random number generator function `runif()` which will produce numbers between 0 and 1 in an apparently random sequence, and later we will use it to introduce variability into our harvesting model.*__
</span>

### __*Manually adding variation to estimates of $R$ for the first few years*__

Re-open the `LogisticModel.R` script (or Markdown file) built in Section 5.3 and change the Population parmaeters to a starting population $N_0 = 50$, $R_0 = 0.2$, $h = 5$ and $K = 100$. That is, we are harvesting at $MSY (= R_0K/4)$ with the population size in equilibrium at 50.

```{r SetModelParamsDev, cache=T}
R0 = 0.2
h = 5
K = 100
Times = 100
StartPopulation = 50
R.deviation = numeric(Times+1)
```

Let us suppose that for the first 6 years, the deviation in $R$ is either 0.2 or -0.2, in an alternating sequence as shown in Figure 5.4-1, but after that there is no deviation and $R$ then follows the normal logistic equation.

* Manually set the first 6 values of `R.deviation` to be alternately +0.2 or -0.2, leaving the rest at zero 

```{r, cache=T}
## set the first 6 values of R.deviation to be alternately +0.2 or -0.2, leaving the rest at zero
R.deviation[1:6] = c(0.2,-0.2, 0.2, -0.2, 0.2, -0.2)
```

Now if we update our model to include these devaitioins in $R$ we can see the result..

```{r, cache=T, fig.cap= "__Fig 5.4-2 Harvest model with manual variation added to $R$__"}
Time = 0:Times
N = numeric(Times+1)
N[N==0]=NA
N[1] = StartPopulation
G.N = numeric(Times+1)
G.N[G.N==0]=NA
delta.N = numeric(Times+1)
delta.N[delta.N==0]=NA
## Run the model with the specified parameters

for (time in 1:Times)
{
  R = R0 * (1 - N[time] / K) + R.deviation[time]
  G.N[time]= R * N[time]
  delta.N[time] = G.N[time] - h
  N[time+1] = N[time] + delta.N[time]
  N[time+1] = ifelse(N[time+1] < 0, 0, N[time+1])
}
## Store the vectors in a data frame and display it (rounding to 2 decimal places)
LogisticGrowth = data.frame(Time, N, G.N, delta.N, R.deviation)
round(head(LogisticGrowth,10),2)

#plot results
ggplot(LogisticGrowth) +                                  
  geom_line(aes(x=Time, y=N), color='blue') +             
  xlab("Time") + ylab("Population (N)") +                 
  ggtitle("Logistic Growth") +
  annotate("text", x = 50, y = N[10], label = label) +      
  theme_classic() + theme(plot.title=element_text(hjust = 0.5))  # this puts the title in the centre                                      
```

The result is that the population collapses: this happens because the last deviation, which is negative, leaves the population below the stable point. As a result, a harvest of 5 cannot be sustained (Figure 5.4-2). More generally, if deviations in $R$ push the population below the lower equilibrium point, the population will be at risk of collapse

--------------------------------------------------------------------------------------------

#### __Exercise__

8.	This exercise assumes that you have built the model HarvestingManualVariation.xlsx shown in Figure 5.4-1 and drawn the plot shown in Figure 5.4-2 for yourself.  
    (a)  What would you expect to happen if the next deviation in $R$
 was +0.2? Why? Hint: `R.deviation[7] = 0.2`
    (b) What happens if the alternating sequence of deviations (+0.2, -0.2…) is continued for another decade (to year 16), ending with a positive deviation? Why do you get this outcome? Hint: use the `rep` function to replicate the sequence of 0.2, -0.2
    (c)  Continue the sequence of alternating positive and negative deviations for the whole time period. How low does the harvest have to be (to the nearest 0.1) to prevent progressive population decline?   
    (d) If the alternating deviations are +0.5 and -0.5 instead of +0.2 and -0.2, how low does the harvest need to be to prevent population collapse?
    
-----------------------------------------------------------------------------------------------

### __*Adding random variation to estimates of $R$ for the whole modelled period*__

In real populations, of course, the deviations in R may vary unpredictably from year to year, though we may be able to estimate the range within which varia- tion occurs. We can use the random number generator `runif` or `rnorm` provided by R to model this situation.

Adding random variation to $R$ means that we are making the model stochastic (Chapter 1)—so that even with the same starting parameters, the exact outcome of the model will be different each time we run it. We will leave the value of $R_0$  at 0.2, the same value as we have used in earlier examples, and modify the value of R for each year by adding a random deviation within the range ± $v$. For example, if $v$ = 0.3, the final value of $R$ might be as low as R -0.3 (a “bad year” when, if $R_0$ = 0.2, populations will always decline) or as high as R +0.3 (a “good year” when they can grow more quickly than usual). That is, instead of calculating $ΔN$ as

$$ΔN = R_0\left( 1-\frac{N}{K}\right)N$$

we calculate it as 

$$ΔN = (R_0\left( 1-\frac{N}{K}\right) +x)N$$

where, if $v$=0.3, $x$ is a random number between -0.3 and =0.3

The R function `runif()` delivers a new random number between 0 and 1 each time it is calculated. This is a little like asking R to toss a coin for you, except instead of “heads” or “tails” with equal probability, Excel will choose a number between 0 and 1, with all possible values equally likely to be chosen. This function can be manipulated to produce random numbers between any range, by altering the `min` and `max` arguments to change the value of v . 


```{r, cache=T}
v=0.15
##  uniform deviations around zero defined by the value of our variation variable
R.deviation = runif(Times+1, -v, v)
```

Each time you run this line of code the model will generate a new set of random numbers and hence produce a different outcome. 

Set the starting population size $N_0 = 100$, $R_0 = 0.2$, $K = 100$, and $h = 5$. That is, we assume that at the start of the simulation, the population has not previously been fished. 

```{r, cache=F}
R0 = 0.2
h = 5
K = 100
Times = 100
StartPopulation = 50
v=0.15
```

```{r, cache=F}
Time = 0:Times
N = numeric(Times+1)
N[N==0]=NA
N[1] = StartPopulation
G.N = numeric(Times+1)
G.N[G.N==0]=NA
delta.N = numeric(Times+1)
delta.N[delta.N==0]=NA
## Run the model with the specified parameters
R.deviation = runif(Times+1, -v, v)
for (time in 1:Times)
{
  R = R0 * (1 - N[time] / K) + R.deviation[time]
  G.N[time]= R * N[time]
  delta.N[time] = G.N[time] - h
  N[time+1] = N[time] + delta.N[time]
  N[time+1] = ifelse(N[time+1] < 0, 0, N[time+1])
}
## Store the vectors in a data frame and display it (rounding to 2 decimal places)
LogisticGrowth = data.frame(Time, N, G.N, delta.N, R.deviation)
round(head(LogisticGrowth,10),2)

label = paste("No = ", StartPopulation,", Ro = ", R0,", K = ",K, ", h = ",h, ", v = ", v)
#plot results
ggplot(LogisticGrowth) +                                  
  geom_line(aes(x=Time, y=N), color='blue') +             
  xlab("Time") + ylab("Population (N)") +                 
  ggtitle("Logistic Growth") +
  annotate("text", x = 50, y = N[10], label = label) +      
  theme_classic() + theme(plot.title=element_text(hjust = 0.5))  # this puts the title in the centre    
```

Everytime we run this code, the plot will be different.

<span style="color:blue">
__*NB You may have noticed that to run this model we are using the same code over and over again and just changing the model parameters ($N_0, R_0, h, K, v$..) To make our lives simpler (and code neater) we can wrap all of the above code into a function*__
</span>

```{r, WriteModelFuntion}
## Start a fucntion that takes our 6 model parameters as arguments

LogisticModel <- function(R0, h, K, Times, StartPopulation, v){
  
  ## Now we just define our empty vectors like we have done before, except this time they are         "wrapped"" in a function
  Time = 0:Times
  N = numeric(Times+1)
  N[N==0]=NA
  N[1] = StartPopulation
  G.N = numeric(Times+1)
  G.N[G.N==0]=NA
  delta.N = numeric(Times+1)
  delta.N[delta.N==0]=NA
  
  ## Create the deviation around R
  R.deviation = runif(Times+1, -v, v)
  
  ## Run the model with the specified parameters
      for (time in 1:Times) {
        R = R0 * (1 - N[time] / K) + R.deviation[time]
        G.N[time]= R * N[time]
        delta.N[time] = G.N[time] - h
        N[time+1] = N[time] + delta.N[time]
        N[time+1] = ifelse(N[time+1] < 0, 0, N[time+1])
    }
  ## Store the vectors in a data frame and display it (rounding to 2 decimal places)
  LogisticGrowth = data.frame(Time, N, G.N, delta.N, R.deviation)
  print(round(head(LogisticGrowth,10),2)) #this will print our data to make sure it has worked
  
  #define what we want our model to "return" - in this case, our data frame
  return(LogisticGrowth)
}

#now lets run our model to see if it works and store results
LogisticGrowth<- LogisticModel(R0=0.2, h=0.5, K=100, Times=100, StartPopulation = 50, v=0.15)

#plot results
ggplot(LogisticGrowth) +                                  
  geom_line(aes(x=Time, y=N), color='blue') +             
  xlab("Time") + ylab("Population (N)") +                 
  ggtitle("Logistic Growth") +
  annotate("text", x = 50, y = N[10], label = label) +      
  theme_classic() + theme(plot.title=element_text(hjust = 0.5))  # this puts the title in the centre  
```



<span style="color:blue">
__*NB Now we can also make our function store the plot as well as the data frame*__
</span>

```{r, AlterModelFuntion}
## Start a fucntion that takes our 6 model parameters as arguments

LogisticModel <- function(R0, h, K, Times, StartPopulation, v){
  
  ## Now we just define our empty vectors like we have done before, except this time they are         "wrapped"" in a function
  Time = 0:Times
  N = numeric(Times+1)
  N[N==0]=NA
  N[1] = StartPopulation
  G.N = numeric(Times+1)
  G.N[G.N==0]=NA
  delta.N = numeric(Times+1)
  delta.N[delta.N==0]=NA
  
  ## Create the deviation around R
  R.deviation = runif(Times+1, -v, v)
  
  ## Run the model with the specified parameters
      for (time in 1:Times) {
        R = R0 * (1 - N[time] / K) + R.deviation[time]
        G.N[time]= R * N[time]
        delta.N[time] = G.N[time] - h
        N[time+1] = N[time] + delta.N[time]
        N[time+1] = ifelse(N[time+1] < 0, 0, N[time+1])
    }
  ## Store the vectors in a data frame and display it (rounding to 2 decimal places)
  LogisticGrowth = data.frame(Time, N, G.N, delta.N, R.deviation)
  #print(round(head(LogisticGrowth,10),2)) #this will print our data to make sure it has worked
  
  ## create the label
  label = paste("No = ", StartPopulation,", Ro = ", R0,", K = ",K, ", h = ",h, ", v = ", v)
  # Store the plot
  p <- ggplot(LogisticGrowth) +                                  
          geom_line(aes(x=Time, y=N), color='blue') +             
          xlab("Time") + ylab("Population (N)") +                 
          ggtitle("Logistic Growth") +
          annotate("text", x = 50, y = 10, label = label) +      
          theme_classic() + theme(plot.title=element_text(hjust = 0.5))  # this puts the title in           the centre  
  print(p) # this prints our plot
  
  #define what we want our model to "return" - in this case, our data frame
  return(list(LogisticGrowth, p))
}
```

```{r, cache=F}
#now lets run our model to see if it works and store results
LogisticGrowth<- LogisticModel(R0=0.2, h=0.5, K=100, Times=100, StartPopulation = 50, v=0.15)
```

No we can look at just the `data.frame` or the plot

```{r, cache=F}
#Data frame
head(LogisticGrowth[[1]])
#plot
LogisticGrowth[[2]]
```


##### __Now if we run the model a number of times we can see the stochastic variation. Note that the variation has increased to 0.35 (higher than the intrinsic growth rate)__

```{r, StochasticVariation, include=FALSE, messages=F}
LG1 <- LogisticModel(R0=0.2, h=0.5, K=100, Times=100, StartPopulation = 50, v=0.15)
LG2 <- LogisticModel(R0=0.2, h=0.5, K=100, Times=100, StartPopulation = 50, v=0.15)
LG3 <- LogisticModel(R0=0.2, h=0.5, K=100, Times=100, StartPopulation = 50, v=0.15)
LG4 <- LogisticModel(R0=0.2, h=0.5, K=100, Times=100, StartPopulation = 50, v=0.15)
LG5 <- LogisticModel(R0=0.2, h=0.5, K=100, Times=100, StartPopulation = 50, v=0.15)
LG6 <- LogisticModel(R0=0.2, h=0.5, K=100, Times=100, StartPopulation = 50, v=0.15)
```

```{r PlotOutputs, message=F, fig.height=12, fig.width=12, out.height=800, out.width=800}
plots <- list(LG1[[2]],LG2[[2]],LG3[[2]],LG4[[2]],LG5[[2]],LG6[[2]])
require(gridExtra)
do.call(grid.arrange,  plots)
```


When you are confident that the model is working as it should, save it as HarvestingStochastic.R

----------------------------------------------------------------------------------------

#### __Excercise__

9.	This exercise assumes that you have built and tested the function `LogisticModel` for yourself.
    (a)  Run the model 30 times with the starting values for $N_0 =100$, $R_0=0.2$, $h=5$, $K=100$, and $v=0.15$ shown above, noting for each run whether the population survived for 100 years or went extinct during that time. What would you conclude about the chances of the population surviving for 100 years? What would you conclude about the chances of the population surviving for 1000 years rather than 100?
__NB if you just want to inspect the graph, runningn `LogisticModel(R0=0.2, h=0.5, K=100, Times=100, StartPopulation = 50, v=0.15)` will show you the results without storing them__
    (b) Try reducing the harvest target. If you run the model 30 times, how low does the value of $h$ need to be in order for the population to survive in all 30 runs?

---------------------------------------------------------------------------------------------

In general, the introduction of random year-to-year variation in the population growth rate will reduces the likelihood that a given level of harvest will be sustainable—and certainly makes harvesting at the theoretical maximum sustainable yield unsustainable in the long term

Notice that our criteria for sustainable harvest are reasonably robust as rules of thumb for coping with randomness as well: we need to harvest at an equilibrium that is to the right of the peak of the production function. However, we have to consider one modification. In this case, we need to be far enough to the right of the peak to avoid the risk of environmental fluctuations causing the population to drop all the way to the other side of the peak, and into the danger zone.

------------------------------------------------------------------------------------------

#### __Exercises__

10. Using your LogisticModel function with $N_0 =50$, $K=100$, and $R_0 = 0.2$, examine the effect of adding five different levels of random variation to $R$:
    + No random variation
    + R ± 0.1 (i.e., scaling = 0.2)
    + R ± 0.2
    + R ± 0.3
    + R ± 0.4

In each case, plot the relationship between harvest level and
the frequency with which the population survives for 100 years, and find the highest "safe" harvest level (to the nearest 0.5) which consistently allows the model population to survive
the 100-year period. (For each combination of variation and harvest target, use at least 30 runs to test for survival.)

11.	Develop a model in which $K$ is subject to random variation. Use it to examine the sensitivity of 100-year survival to the level of variation in $K$ (use levels up to ± K ). In which parameter, $R$ or $K$, does variability appear to have most impact?
 
------------------------------------------------------------------------------------------


In order to cope with random variation, fisheries managers will normally attempt to monitor the size of the stock carefully, so that if environmental con- ditions are unfavourable and the stock has a “bad year”, the harvest targets can be reduced to compensate. This means being far enough to the right of the peak of the production function that a decline below the peak is not only likely to be very rare, but will be a big enough crash to be obvious in stock assessments, so that the adjustments to harvest targets can be made immediately. While this is technically straightforward, the political and economic consequences of a reduction in the allowable catch may make its implementation difficult, as we discuss later. Also, the initial, short term reductions in harvest needed to bring depleted stocks back up to a safe population size also often meet with considerable resistance. This is partly because such large population sizes have not been seen for generations of fishers. Depleted stocks have become a “new normal”, and convincing fishers, politicians, and the public that cutting back on catches and restoring stocks will in many cases lead to bigger catches in the long run, has not been an easy task.

## __5.5 Complications and difficulties__

Logistic growth is a good general model to explain why fisheries are so prone to collapse, and why setting harvest targets to the maximum sustainable yield (MSY) is a high-risk strategy. In section 5.3 we concluded that the safest way to manage a fishery would be to ensure that the harvest target (or “total allow- able catch”, TAC), and hence the target stock size, were set to the right of the peak in the fishery’s production function—that is, with a TAC below MSY. For the logistic growth model, this means a target stock size greater than $K/2$. This basic guideline—that a sustainable strategy requires that the population size be greater than the one producing MSY, and that the harvest has to be less than MSY, is very robust.

In managing any particular real fishery, however, we need numerical targets – what is the peak of the production function? At what population size is this peak attained? Generally, the simple logistic model isn’t quite good enough to serve this purpose. Instead, we need a model that is tailored to the biology of the particu- lar fishery population being managed, and that is calibrated well enough to pro- vide those numerical targets we are after. Used for those purposes, there are some additional complications, in particular the four below:     

1. The logistic model may not be a sufficiently precise description of how the population grows. For instance, individuals might not start reproduc- ing the same year they recruit to the population. It may take them years, or in the case of deep sea fishes, and megafauna like whales, decades to become reproductively mature.       
2. The parameters of the population growth model (whether logistic or not) may change from year to year as a result of factors which have nothing to do with the fishery. In section 5.4 we found that the introduction of random variation into the model made sustainable harvests more diffi- cult to achieve: year-to-year variation in population parameters may be very high in many real populations.     
3. Estimating parameter values and monitoring the stock size may be very difficult indeed. In Section 5.3 we examined the effect of estimation errors if harvesting was set at MSY.   
4. Managing the fishery requires the management of people and corporations whose incomes and livelihood are seriously affected by decisions about fishery targets. A decision to reduce harvest targets may have very significant economic—and consequently, political—effects.
    
### __Does the population really show logistic growth?__

#### __*Linearity Assumptions*__

Remember that logistic growth assumes density-dependent growth rates defined by a negative linear relationship between both $b$ and $d$ and $N$ (Figure 5.3-2), so that there is a linear relationship between R and N. In many cases, density-dependence does not take this form. The example below is for sea lampreys which have invaded the Great Lakes in North America. The x axis is a measure of adult female density ($N/2$), the y axis is a measure of total recruitment. We do not need to actually calculate values of $b$ ($y/2x$) to know that its relationship with $N$ is emphatically non-linear!

<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.5.1.png)
</div>

Sometimes, the relationship between $R$ and $N$ proves to be logarithmic (that is, although $R$ vs $N$ is not linear, $ln(R)$ vs $ln(N)$ is) (e.g., Lewis et al 2001). Other relationships have also been used (Brook & Bradshaw 2006).

Another deviation from the assumption of linear decline in $R$ as $N$ increases may occur at very low densities. Now that so many commercially fished stocks are down to less than 20% of their historic size, what happens at low densities has become very important. The logistic equation assumes that the highest per capita rate of increase occurs at the lowest population density. But, per capita recruitment and survival may actually drop again at very low population densities (see Figure 5.5-2 below). This is particularly likely in sedentary species that use broadcast spawning to reproduce (i.e., they release sperm and eggs into the water, and these gametes need to make contact with one another for fertilization and development to take place), some social species, and species which reproduce in groups. This phenomenon of decreased $R$ at small population sizes is called “depensation” or an “Allee effect” (after the person who first described it).

Depensation has been described in a number of fish species, including cod (Rose 2004). Where it exists, fisheries are very unlikely to recover easily from collapse, which makes it even more important to stay on the right-hand side of the production function—and perhaps to protect some high-density popula- tions from fishing altogether.

<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.5.2.png)
</div>

If the relationship between $R$ and $N$ is not linear, the model will need to change to accommodate that, and the shape of the production function will also change. This is not a major modelling difficulty, although the equations to describe population growth will be more complicated.

#### __*Lags*__

A less obvious assumption built into the logistic equation is that density- dependent effects are instantaneous—that is, as soon as the population num- bers increase, R declines. Sometimes these effects actually operate with a lag — for example, if the population in one year influences its food supply for the next year, or if individuals which are crowded when juveniles lay fewer eggs as adults. Lags like this will tend to destabilize the system, and in any case may require more complex (and usually, age-structured) models.

#### __*Age Structure*__

The logistic equation assumes that every individual has a equal effect on per capita rates of increase. For long-lived, slow-maturing species, that may not be the case. Older, larger fish occupy more space, eat more of the available food supply, and produce many more eggs per year, than smaller, younger fish. Sometimes—as in the case of the cod—this may be handled by using fish biomass rather than fish numbers as a measure of stock size. But if biomass is not an adequate measure, and it is important to predict numbers of individuals, then the population model may need to include age structure, and to keep track of the numbers of individuals in each year class. Although we will not consider age-structured models here, they are very commonly used.

#### __*Species Interactions*__

No population exists in isolation, and a fish has more to cope with than avoiding harvest. It is dependent on other species as food, must avoid its own predators, and may share its environment with competing species. Some of these interac- tions will also be affected by harvesting techniques. For example, harvesting may take a “bycatch”—other species accidentally caught—or, like trawling, damage the communities living on the ocean bottom. Secondary effects of harvesting which affect the harvested species interactions with other biota may be very difficult to model, but can nonetheless have significant impacts on the fishery.
 
### __Environmental variation in population growth parameters__
 
Both carrying capacity and per capita rate of increase may vary from year to year, quite independently of the fishery. Natural populations which are not harvested show considerable year-to-year variation in size, associated with climatic variation, food availability, and other factors—and as we have seen in section 5.4, this makes sustainable harvests more difficult to achieve. When this natural variation pushes population numbers into the left half of their production function, continuing to fish is likely to have bad consequences.

For example, the Peruvian anchoveta fishery in the eastern Pacific is strongly affected by the El Niño / La Niña climatic cycle (Chapter 7). Because of upwelling, the coastal waters of Peru produce dense plankton blooms, and the main beneficiary of the plankton productivity is a small fish, up to 20cm long, called the anchoveta (Engraulis ringens). In an El Niño year, upwelling ceases, and recruitment falls because the plankton blooms do not occur.

<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.5.3.png)
</div>

Historically, the fishery recovered rapidly after El Niño events. Until World War II, the anchoveta was fished only for local consumption, but from 1950 onward it began to be used to make fishmeal for the global market (fishmeal is mostly used as livestock and poultry food).

The fishery then grew very fast: a stock assessment in 1968 suggested that it could safely yield 10 million tons per year: but in 1971, about 12 million tonnes were taken. Then, 1972 was a severe El Niño year, and the combination of failed recruitment and over-fishing meant that by mid-1972, only a small part of the former stock appeared to have survived. In early 1973 the fishery was closed briefly, but was then reopened for a short season (against the recommendations of the Peruvian fisheries managers). This time, the stock did not bounce back—the catch remained low for more than 20 years (Figure 5.5-4). The period included more El Niño events than usual, so that average per capita recruitment was low and the fishery simply could not recover from fishing as it otherwise might have done.

<div style="text-align:center" markdown="1">
![](Chapter 5/Fig5.5.4.png)
</div>

### __Parameter and stock size estimates__

Determining the form of the relationship between $R$ and $N$ normally uses a time series of population size estimates and then looks for the relationship between the rate of increase of $R$ and $N$. (l can be estimated as
 
t +1  and used to estimate
Nt
 
R: see Exercise 2.) But as we noted for the anchoveta, the values of N may vary
for all kinds of reasons other than density-dependent effects. Consequently the data are noisy and the parameter estimates are very prone to error. And for many marine species, simply estimating stock size is a major technical problem. This is a particularly strong reason for caution in setting harvest targets.

### __Economic and political issues__

Despite the technical complications outlined above, the scientific and modelling problems fade into insignificance compared to the economic and political problems that have historically accompanied fisheries management. When a fishery collapses, it often does so with amazing speed (like the cod and anchoveta did) often after many years of profitability—precisely the pattern we should expect from the harvesting models (see Figure 5.3-13, for example). It is very difficult to persuade people that disaster is looming when there are still enough fish to support the fishery, and the fisheries literature is full of examples where advice to reduce harvest rates has been ignored (a) because of the social and economic dislocation that a reduction in industry activity would cause, (b) because the decision-maker, too, could not believe that the risk was real, and/or (c) there was no mechanism in place to enforce harvest reductions. Even after a collapse has occurred, many people involved in the collapsed fishery have found it hard to believe that cumulative overfishing could really have been the cause—on the grounds that an apparently sudden event like the collapse must have had a new and sudden cause. And there is a long history of substantial subsidy to fishing industries around the world (often in the form of fuel subsidies), leading to an overcapacity of boats and processing plants, and consequently more pressure to use that capacity to keep fishing.

In recent years, however, the situation has changed somewhat. Because pessimistic fisheries managers have so often been proven right, global catch rates continue to decline, and there are more collapsed and vulnerable fish stocks than there are healthy ones. Consequently the need to manage fisheries resources sensibly and cautiously has become acute and much more widely recognized. As a result, advice from fisheries managers is a little less likely to be ignored, at least in developed countries. This makes it more important to develop robust and realistic models for the growth and behaviour of the fish stocks we exploit. If we can do that, it is very likely that your grandchildren will indeed eat seafood—though much of it may be farmed!

## __5.6 References__

Aranda M (2009) Evolution and state of the art of fishing capacity management in Peru: the case of the anchoveta fishery. Pan-American Journal of Aquatic Sciences 4: 146-153.

Brook BW & Bradshaw CJA (2006) Strength of evidence for density dependence in abundance time series of 1198 species. Ecology 87: 1445-1451.
 
Dichmont C & Jarret A (2007) Northern Prawn Fishery (NPF) harvest strategy under input controls. Australian Fisheries Management publication R2006/1128. http://www.afma.gov.au/fisheries/northern_trawl/northern_prawn/notices/2010/n20100309_fb/harvest_strategy.pdf

Hu Y, Shang H, Tong H, Nehlich O, Liu W, Zhao C, Yu J, Wang C et al. (2009). Stable isotope dietary analysis of the Tianyuan 1 early modern human. Proceedings of the National Academy of Sciences 106 (27): 10971-10974.

Kirby MX (2004) Fishing down the coast: historical expansion and collapse of oyster fisheries along continental margins. Proceedings of the National Academy of Sciences 101 (35): 13096-13099

Kurlansky M (1997) Cod: a Biography of the Fish that Changed the World. 288pp Random House UK.

Lewis S, Sherratt TN, Hamer KC, Wanless S (2001) Evidence of intra-specific competition for food in a pelagic seabird. Nature 412: 816-819.

Martinez-Gonzalez MA, de la Fuente-Arrillaga C, Nunez-Cordoba JM, Basterra-Gortari  FJ,  Beunza  JJ,  Vazquez  Z,  Benito  S,  Tortosa  Z, Bes-Rastrollo M (2008) Adherence to Mediterranean diet and risk of developing diabetes: prospective cohort study. British Medical Journal 336 (7657): 1348-1351.

Phillips  K,  Begg  G  &  Curtotti  R  (2008)  Southern  Bluefin Tuna  Fishery. Ch 24 in Fishery Status Reports 2008: Status of Fish Stocks and Fisheries managed by the Australian Government Bureau of Rural Sciences and Australian Bureau of Agricultural and Resource Economics, Canberra. http://www.daff.gov.au/_data/assets/pdf_file/0004/1284511/Fishery_status_reports_2008.pdf

Rose GA (2004) Reconciling overfishing and climate change with stock dynamics of Atlantic cod (Gadus morhua) over 500 years. Canadian Journal of Fisheries and Aquatic Sciences 61: 1553-1557.

Rose A (2008) Who killed the Grand Banks? The untold story behind the decimation of one of the world’s greatest natural resources. Wiley & Sons, Canada.

Roughgarden J & Smith F (1996) Why fisheries collapse and what to do about it. Proceedings of the National Academy of Sciences 93: 5078-5083. Roughgarden J (1998) Primer of Ecological Theory. Prentice-Hall, London.

Royce  WF  (1985)  The  Historical  Development  of  Fisheries  Science  and Management. http://www.nefsc.noaa.gov/history/stories/fsh_sci_history1.html

Sofi F, Cesari F, Abbate R, Gensini F, Casini A (2008) Adherence to Medi- terranean diet and health status: meta-analysis. British Medical Journal 337:1136-1143. http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2533524/pdf/bmj.a1344.pdf
 
Ylioja T, Roinizen H, Ayres MP, Rousi M, & Price PW (1999) Host-driven population dynamics in a herbivorous insect. Proceedings of the Nataional Academy of Sciences 96: 10735-10740

Worm B, Barbier EB, Beaumont N, Duffy JE, Folke C, Halpern BS, Jackson JBC, Lotze HK, Micheli F, Palumbi SR, Sala E, Selkoe KA, Stachowicz JJ & Watson R (2006) Impacts of biodiversity loss on ocean ecosystem services. Science 314: 787-790.
 




